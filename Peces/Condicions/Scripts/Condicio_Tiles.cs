using System.Collections;
using System.Collections.Generic;
using UnityEngine;

[CreateAssetMenu(menuName = "Xido Studio/Hex/Condicio/byTiles")]
public class Condicio_Tiles : Condicio
{
    [Linia]
    [Apartat("CONDICIO TILES")]
    [SerializeField] List<Tile> tilesBuscats;

    [Tooltip("En comptes de complirse quan troba algun dels tiles, es complirà quan no en trobi cap.")]
    [SerializeField] bool invertit;

    public override bool Comprovar(Peça peça, Grups grups, Estat cami, bool canviar, System.Action<Peça, bool, int> enConfirmar, System.Action<Peça, int> enCanviar)
    {
        if (peça.SubestatIgualA(objectiu))
            return false;

        if (!invertit)
        {
            for (int i = 0; i < peça.Tiles.Length; i++)
            {
                if (tilesBuscats.Contains(peça.Tiles[i].PossibilitatsVirtuals.Get(0).Tile))
                {
                    enConfirmar.Invoke(peça, canviar, punts);
                    if (canviar)
                        Canviar(peça, enCanviar);
                    return true;
                }
            }
        }
        else //INVERTIT
        {
            for (int i = 0; i < peça.Tiles.Length; i++)
            {
                if (!tilesBuscats.Contains(peça.Tiles[i].PossibilitatsVirtuals.Get(0).Tile))
                {
                    enConfirmar.Invoke(peça, canviar, punts);
                    if (canviar)
                        Canviar(peça, enCanviar);
                    return true;
                }
            }
        }
        
       

        return false;
    }

    new public void OnValidate()
    {
        base.OnValidate();
    }
}
